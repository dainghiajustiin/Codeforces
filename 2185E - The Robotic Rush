#include<bits/stdc++.h>
using namespace std;

//#define int long long
#define fi first
#define se second
#define pb push_back
#define el '\n'
#define all(x) x.begin(), x.end()

using ll = long long;
using pii = pair<int,int>;
using ull = unsigned long long;

const int MOD1 = 1000000007;
const int MOD2 = 998244353;

mt19937_64 rd(time(0));
ll rand(ll l, ll r){
    return l + rd() % (r - l + 1);
}

///
const int maxN = (int) 2e5 + 7;
int n, m, k, curValue, ans, a[maxN];
bool del[maxN];
string s;
vector<int> v;
vector<pii> L, R;
///

void init(){

}

void solve(int iTest){
    cin >> n >> m >> k;

    L.clear(), R.clear(), v.clear();
    curValue = 0, ans = n;

    for(int i = 1; i <= n; i++) del[i] = 0;

    for(int i = 1; i <= n; i++){
        cin >> a[i];
    }

    for(int i = 1; i <= m; i++){
        int x; cin >> x;
        v.pb(x);
    }

    cin >> s;

    sort(all(v));
    v.resize(unique(all(v)) - v.begin());

    for(int i = 1; i <= n; i++){
        int pos = lower_bound(all(v), a[i]) - v.begin();
        int vL, vR;

        if(pos == 0) vL = -MOD1;
        else vL = -(a[i] - v[pos-1]);
        L.pb({vL, i});

        if(pos > v.size() - 1) vR = MOD1;
        else vR = v[pos] - a[i];
        R.pb({vR, i});
    }

    sort(all(L));
    sort(all(R),  __greater());

    for(char& elm:s){
        if(elm == 'L'){
            curValue--;
            while(!L.empty()){
                int last = L.size() - 1;
                int value = L[last].fi;
                int id = L[last].se;
                if(del[id] == 1){
                    L.pop_back();
                    continue;
                }
                if(value == curValue){
                    del[id] = 1;
                    L.pop_back();
                    ans--;
                    continue;
                }
                break;
            }
        }
        else{
            curValue++;
            while(!R.empty()){
                int last = R.size() - 1;
                int value = R[last].fi;
                int id = R[last].se;
                if(del[id] == 1){
                    R.pop_back();
                    continue;
                }
                if(value == curValue){
                    del[id] = 1;
                    R.pop_back();
                    ans--;
                    continue;
                }
                else break;
            }
        }

        cout << ans << ' ';
    }
    cout << el;
}

signed main(){
    ios_base::sync_with_stdio(0);
    cin.tie(0);

    #define task "buon"
    if(fopen(task".inp", "r")){
        freopen(task".inp", "r", stdin);
        freopen(task".out", "w", stdout);
    }

    init();

    int nTest = 1;
    cin >> nTest;

    for(int iTest = 1; iTest <= nTest; iTest++){
        solve(iTest);
    }

    return 0;
}

/// Code by: Justiin
